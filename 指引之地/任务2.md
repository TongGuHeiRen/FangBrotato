①创建场景/资源（与《主场景实战》目录与命名保持一致）
[ ] 在 场景/ 创建 敌人.tscn，根节点“敌人”(CharacterBody2D)，添加 Sprite2D“敌人图像”和 CollisionShape2D“碰撞形状”，附 脚本/敌人.gd
[ ] 在 场景/ 创建 掉落物.tscn，根节点“掉落金币”(Area2D)，附 脚本/掉落物.gd
[ ] 在 场景/ 创建 生成器.tscn，根节点“生成器”(Node2D)，附 脚本/生成器.gd
[ ] 在 场景/ 创建 波次管理器.tscn，根节点“波次管理器”(Node)，附 脚本/波次管理器.gd
[ ] 在 场景/ 创建 HUD.tscn，根节点“HUD”(CanvasLayer)，附 脚本/顶部ui.gd
[ ] 在 场景/ 创建 菜单场景.tscn，根节点“菜单场景”(Control)，附 脚本/菜单场景.gd（process_mode=PROCESS_MODE_ALWAYS）
[ ] 在 场景/ 创建 结果面板.tscn，根节点“结算面板”(Control)，附 脚本/结果面板.gd
[ ] 在 资源/ 添加占位贴图与字体（敌人/金币/HUD 文本）以便快速验证
[ ] 在 单例/ 创建 GameSession.gd（运行时状态管理，设为 AutoLoad 单例）
[ ] 在 场景/主场景.tscn 的“主场景”下预留空节点“敌人容器”“掉落容器”用于实例挂载

②子节点树
[ ] 在“主场景”下添加 Node2D“敌人容器”和 Node2D“掉落容器”
[ ] 在“主场景”实例化 场景/Spawner.tscn 为“生成器”
[ ] 在“主场景”实例化 场景/WaveManager.tscn 为“波次管理器”
[ ] 在“主场景/UI层”实例化 场景/HUD.tscn 为“HUD”（常驻显示）
[ ] 在“主场景/UI层”实例化 场景/MenuScene.tscn 为“菜单场景”（默认隐藏，process_mode=PROCESS_MODE_ALWAYS）
[ ] 在“主场景/UI层”实例化 场景/ResultPanel.tscn 为“结算面板”（默认隐藏）
[ ] 在“生成器”下添加 Timer“生成计时器”（one_shot=false，autostart=false）
[ ] 在“波次管理器”下添加 Timer“波次计时器”（one_shot=true）与 Timer“间隔计时器”（one_shot=false）
[ ] 在 Enemy.tscn 可选添加 NavigationAgent2D“寻路代理”（可选）
[ ] 确保“玩家”节点（Player.tscn 根节点：CharacterBody2D，名称“玩家”）在“主场景”可被“敌人”与“生成器”通过 NodePath 获取

③脚本与关键 API（函数/信号/export 变量名）
[ ] 在 脚本/敌人.gd 导出 export var 速度: float、生命: int、目标路径: NodePath；onready 获取子节点“敌人图像”“碰撞形状”
[ ] 在 脚本/敌人.gd 实现 函数：初始化(目标: Node2D)、移动(目标位置: Vector2)、追踪玩家(时间增量: float)、受到伤害(伤害值: int)、死亡()
[ ] 在 脚本/敌人.gd 定义 信号：已死亡(奖励金币: int)
[ ] 在 脚本/掉落物.gd 导出 export var 金币值: int = 1、吸附半径: float（可选）
[ ] 在 脚本/掉落物.gd 实现 函数：被玩家拾取(玩家: Node)、自动吸附到玩家(时间增量: float, 玩家: Node2D)（可选）；信号：被拾取(数量: int)
[ ] 在 脚本/生成器.gd 导出 export var 敌人预设: PackedScene、刷新点: Array[Vector2]、每批数量: int
[ ] 在 脚本/生成器.gd 实现 函数：生成一只()、生成一组(数量: int)、清空()；信号：已生成(敌人: Node)
[ ] 在 脚本/波次管理器.gd 导出 export var 波次表: Array[Dictionary]（字段: 持续秒、每秒、数量上限）
[ ] 在 脚本/波次管理器.gd 实现 函数：开始波次(索引: int = 0)、结束当前波次(胜利: bool)、获取当前剩余时间() -> float
[ ] 在 脚本/波次管理器.gd 定义 信号：波次开始(索引: int, 时长: float)、波次结束(索引: int, 胜利: bool)、请求生成(数量: int)
[ ] 在 脚本/顶部ui.gd onready 获取 金币/生命/波次/计时 Label，并实现 设置金币(值: int)
[ ] 在 脚本/顶部ui.gd 实现 设置生命(值: int)、设置波次(索引: int)、设置计时(秒: float)；信号：请求打开菜单()
[ ] 在 脚本/菜单场景.gd 设定 process_mode=PROCESS_MODE_ALWAYS；信号：请求继续()、请求重开()、请求退出()；实现 显示() 与 隐藏()（切换可见性与输入聚焦）
[ ] 在 脚本/结果面板.gd 实现 显示胜利(统计: Dictionary)、显示失败(统计: Dictionary)、隐藏()；信号：请求重开()
[ ] 在 单例/GameSession.gd 定义 变量：金币: int、生命: int、波次索引: int、正在进行: bool
[ ] 在 单例/GameSession.gd 定义 信号：金币变化(值: int)、生命变化(值: int)、波次变化(索引: int)、游戏结束(胜利: bool)
[ ] 在 单例/GameSession.gd 实现 函数：重置()、增加金币(n: int)、扣除生命(n: int)、设置波次(索引: int)、结束游戏(胜利: bool)
[ ] 若已按《主场景实战》创建 管理器/GameManager.gd 并实现敌人/波次逻辑：将对应职责迁移为“生成器/波次管理器”，或由 GameManager 仅作协调者，通过连接信号与上述场景对接，避免重复计时与生成逻辑

④与主流程集成
[ ] 在 主场景.gd 预加载并实例化“生成器”“波次管理器”“HUD”“菜单场景”“结算面板”
[ ] 在 主场景.gd 将“生成器”“波次管理器”添加为子节点并缓存对“敌人容器/掉落容器/玩家”的引用
[ ] 将 波次管理器.gd 的 信号 请求生成(数量) 连接到 生成器.gd 的 生成一组(数量)
[ ] 在 生成器.gd 已生成(敌人) 时添加到“敌人容器”，并设置敌人目标为“玩家”（调用 敌人.初始化(玩家) 或设置 目标路径）
[ ] 在 敌人.gd 已死亡(奖励金币) 时实例化 场景/掉落物.tscn 到“掉落容器”，并调用 GameSession.增加金币(奖励金币)
[ ] 在 掉落物.gd 被拾取(数量) 时调用 GameSession.增加金币(数量) 并 queue_free()
[ ] 在 GameSession.gd 金币变化/生命变化/波次变化 信号连接到 Hud.gd 设置金币/设置生命/设置波次
[ ] 在 WaveManager.gd 波次开始/波次结束 信号连接到 Hud.gd 设置计时，并控制 Spawner.gd 启停
[ ] 在 玩家死亡 时调用 GameSession.结束游戏(false) 并显示“结算面板”.显示失败(统计)
[ ] 在 所有波次完成 时调用 GameSession.结束游戏(true) 并显示“结算面板”.显示胜利(统计)
[ ] 在 HUD 请求打开菜单 时显示“菜单场景”，设置 get_tree().paused = true
[ ] 在 菜单场景 请求继续 时隐藏“菜单场景”，设置 get_tree().paused = false
[ ] 在 菜单场景 请求重开 或 结算面板 请求重开 时：清空“敌人容器/掉落容器”，GameSession.重置()，波次管理器.开始波次(0)
[ ] 在 菜单场景 请求退出 时返回主菜单或退出（按项目约定实现）
[ ] 在 _process 或 定时器回调 中读取 波次管理器.获取当前剩余时间() 并 HUD.设置计时(秒)
[ ] 确保 菜单场景.tscn 与 结果面板.tscn 在暂停时可交互（process_mode=PROCESS_MODE_ALWAYS）
